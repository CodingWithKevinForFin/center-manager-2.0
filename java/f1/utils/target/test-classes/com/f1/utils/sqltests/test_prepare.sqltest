****TEST_INPUT_QUERY****
{prepare x, y, z, stack(x), count(y), norm(z), stack(x * y), norm(x - y * z), x - offset(y, -1) * offset(z, 1) as calc from input;}
****TEST_INPUT_GLOBAL_VARS****
{}
****TEST_INPUT_TABLES****
input
+-----------------------------+
|            input            |
+--------+------+------+------+
|category|x     |y     |z     |
|String  |Double|Double|Double|
+--------+------+------+------+
|A       |-4.2  |5.5   |8.8   |
|B       |4.0   |11.1  !null  |
|A       |0.9   |-0.8  |0.4   |
|A       !null  |-4.7  |33.4  |
|C       |-3.3  !null  |16.1  |
|C       |4.9   |-17.1 |-99.0 |
|B       |1.2   |1.3   |-23.4 |
|B       !null  |-7.7  |90.1  |
|C       |4.2   |5.0   !null  |
|A       |9.9   |5.0   |34.5  |
|B       |-3.4  |3.2   |22.2  |
|C       |-0.8  |8.9   !null  |
|C       !null  |-9.8  !null  |
|D       !null  !null  !null  |
+--------+------+------+------+

****TEST_RESULT****
+------+------+------+--------------------+-------+-------------------+-------------------+--------------------+------------------+
|x     |y     |z     |stack_x             |count_y|norm_z             |stack_x_y          |norm_x_y_z          |calc              |
|Double|Double|Double|Double              |Integer|Double             |Double             |Double              |Double            |
+------+------+------+--------------------+-------+-------------------+-------------------+--------------------+------------------+
|-4.2  |5.5   |8.8   |-4.2                |1      |0.1058965102286402 |-23.1              |0.027046482928835873!null              |
|4.0   |11.1  !null  |-0.20000000000000018|2      |0.1058965102286402 |21.299999999999997 |0.027046482928835873|1.7999999999999998|
|0.9   |-0.8  |0.4   |0.6999999999999998  |3      |0.11070998796630567|20.58              |0.026419169066227894|-369.84           |
!null  |-4.7  |33.4  |0.6999999999999998  |4      |0.5126353790613719 |20.58              |0.026419169066227894!null              |
|-3.3  !null  |16.1  |-2.6                |4      |0.7063778580024068 |20.58              |0.026419169066227894|-468.6            |
|4.9   |-17.1 |-99.0 |2.3000000000000003  |5      |-0.4849578820697954|-63.21000000000001 |0.8943747429041546  !null              |
|1.2   |1.3   |-23.4 |3.5                 |6      |-0.766546329723225 |-61.650000000000006|0.8781160016454135  |1541.91           |
!null  |-7.7  |90.1  |3.5                 |7      |0.3176895306859206 |-61.650000000000006|0.8781160016454135  !null              |
|4.2   |5.0   !null  |7.7                 |8      |0.3176895306859206 |-40.650000000000006|0.8781160016454135  |269.85            |
|9.9   |5.0   |34.5  |17.6                |9      |0.7328519855595668 |8.849999999999994  |0.9617235705470999  |-101.1            |
|-3.4  |3.2   |22.2  |14.200000000000001  |10     |1.0                |-2.0300000000000065|1.0                 !null              |
|-0.8  |8.9   !null  |13.4                |11     |1.0                |-9.150000000000007 |1.0                 !null              |
!null  |-9.8  !null  |13.4                |12     |1.0                |-9.150000000000007 |1.0                 !null              |
!null  !null  !null  |13.4                |12     |1.0                |-9.150000000000007 |1.0                 !null              |
+------+------+------+--------------------+-------+-------------------+-------------------+--------------------+------------------+

****TEST_QUERY_PLAN****
QUERY_RECEIVED : 
PREPARE x,y,z,stack(x),count(y),norm(z),stack(x * y),norm(x - y * z),x - offset(y,-1) * offset(z,1) AS calc FROM input

PROJECTION : 
PREPARE x,y,z,stack(x),count(y),norm(z),stack(x * y),norm(x - y * z),x - offset(y,-1) * offset(z,1) AS calc FROM input

QUERY_COMPLETED : 
ColumnarTable


****TEST_RESULT_GLOBAL_VARS****
{}
****TEST_RESULT_TABLES****
input
+-----------------------------+
|            input            |
+--------+------+------+------+
|category|x     |y     |z     |
|String  |Double|Double|Double|
+--------+------+------+------+
|A       |-4.2  |5.5   |8.8   |
|B       |4.0   |11.1  !null  |
|A       |0.9   |-0.8  |0.4   |
|A       !null  |-4.7  |33.4  |
|C       |-3.3  !null  |16.1  |
|C       |4.9   |-17.1 |-99.0 |
|B       |1.2   |1.3   |-23.4 |
|B       !null  |-7.7  |90.1  |
|C       |4.2   |5.0   !null  |
|A       |9.9   |5.0   |34.5  |
|B       |-3.4  |3.2   |22.2  |
|C       |-0.8  |8.9   !null  |
|C       !null  |-9.8  !null  |
|D       !null  !null  !null  |
+--------+------+------+------+

