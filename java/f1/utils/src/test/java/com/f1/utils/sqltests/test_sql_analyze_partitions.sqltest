****TEST_INPUT_QUERY****
create table test as analyze g, n, x, y, sum(win.x), sum(win.y) from analyze_partitions_input window win on n - 3 < win.n && win.n <= n partition by g;
****TEST_INPUT_GLOBAL_VARS****
{}
****TEST_INPUT_TABLES****
analyze_partitions_input
+-----------------------------+
|  analyze_partitions_input   |
+-------+-------+------+------+
|g      |n      |x     |y     |
|Integer|Integer|Double|Double|
+-------+-------+------+------+
|1      |1      |4.0   |5.0   |
|1      |2      |4.0   |2.0   |
|1      |3      |4.0   |3.0   |
|1      |4      |4.0   |0.0   |
|1      |5      |4.0   |8.0   |
|2      |1      |7.0   |5.0   |
|2      |2      |7.0   |0.0   |
|2      |3      |7.0   |0.0   |
|2      |4      |7.0   |2.0   |
|2      |5      |7.0   |3.0   |
|3      |1      |8.0   |3.0   |
|3      |2      |8.0   |1.0   |
|3      |3      |8.0   |2.0   |
|3      |4      |8.0   |8.0   |
|3      |5      |8.0   |9.0   |
|4      |1      |0.0   |2.0   |
|4      |2      |0.0   |3.0   |
|4      |3      |0.0   |0.0   |
|4      |4      |0.0   |2.0   |
|4      |5      |0.0   |2.0   |
|5      |1      |3.0   |3.0   |
|5      |2      |3.0   |8.0   |
|5      |3      |3.0   |5.0   |
|5      |4      |3.0   |6.0   |
|5      |5      |3.0   |7.0   |
+-------+-------+------+------+

****TEST_RESULT****
25
****TEST_QUERY_PLAN****
QUERY_RECEIVED : 
CREATE TABLE AS test  ANALYZE g,n,x,y,sum(win . x),sum(win . y) FROM analyze_partitions_input WINDOW win ON n - 3 < win . n && win . n <= n PARTITION BY g

PROJECTION : 
ANALYZE g,n,x,y,sum(win . x),sum(win . y) FROM analyze_partitions_input WINDOW win ON n - 3 < win . n && win . n <= n PARTITION BY g

QUERY_COMPLETED : 
ColumnarTable


****TEST_RESULT_GLOBAL_VARS****
{}
****TEST_RESULT_TABLES****
analyze_partitions_input
+-----------------------------+
|  analyze_partitions_input   |
+-------+-------+------+------+
|g      |n      |x     |y     |
|Integer|Integer|Double|Double|
+-------+-------+------+------+
|1      |1      |4.0   |5.0   |
|1      |2      |4.0   |2.0   |
|1      |3      |4.0   |3.0   |
|1      |4      |4.0   |0.0   |
|1      |5      |4.0   |8.0   |
|2      |1      |7.0   |5.0   |
|2      |2      |7.0   |0.0   |
|2      |3      |7.0   |0.0   |
|2      |4      |7.0   |2.0   |
|2      |5      |7.0   |3.0   |
|3      |1      |8.0   |3.0   |
|3      |2      |8.0   |1.0   |
|3      |3      |8.0   |2.0   |
|3      |4      |8.0   |8.0   |
|3      |5      |8.0   |9.0   |
|4      |1      |0.0   |2.0   |
|4      |2      |0.0   |3.0   |
|4      |3      |0.0   |0.0   |
|4      |4      |0.0   |2.0   |
|4      |5      |0.0   |2.0   |
|5      |1      |3.0   |3.0   |
|5      |2      |3.0   |8.0   |
|5      |3      |3.0   |5.0   |
|5      |4      |3.0   |6.0   |
|5      |5      |3.0   |7.0   |
+-------+-------+------+------+

test
+-------------------------------------------------+
|                      test                       |
+-------+-------+------+------+---------+---------+
|g      |n      |x     |y     |sum_win_x|sum_win_y|
|Integer|Integer|Double|Double|Double   |Double   |
+-------+-------+------+------+---------+---------+
|1      |1      |4.0   |5.0   |4.0      |5.0      |
|1      |2      |4.0   |2.0   |8.0      |7.0      |
|1      |3      |4.0   |3.0   |12.0     |10.0     |
|1      |4      |4.0   |0.0   |12.0     |5.0      |
|1      |5      |4.0   |8.0   |12.0     |11.0     |
|2      |1      |7.0   |5.0   |7.0      |5.0      |
|2      |2      |7.0   |0.0   |14.0     |5.0      |
|2      |3      |7.0   |0.0   |21.0     |5.0      |
|2      |4      |7.0   |2.0   |21.0     |2.0      |
|2      |5      |7.0   |3.0   |21.0     |5.0      |
|3      |1      |8.0   |3.0   |8.0      |3.0      |
|3      |2      |8.0   |1.0   |16.0     |4.0      |
|3      |3      |8.0   |2.0   |24.0     |6.0      |
|3      |4      |8.0   |8.0   |24.0     |11.0     |
|3      |5      |8.0   |9.0   |24.0     |19.0     |
|4      |1      |0.0   |2.0   |0.0      |2.0      |
|4      |2      |0.0   |3.0   |0.0      |5.0      |
|4      |3      |0.0   |0.0   |0.0      |5.0      |
|4      |4      |0.0   |2.0   |0.0      |5.0      |
|4      |5      |0.0   |2.0   |0.0      |4.0      |
|5      |1      |3.0   |3.0   |3.0      |3.0      |
|5      |2      |3.0   |8.0   |6.0      |11.0     |
|5      |3      |3.0   |5.0   |9.0      |16.0     |
|5      |4      |3.0   |6.0   |9.0      |19.0     |
|5      |5      |3.0   |7.0   |9.0      |18.0     |
+-------+-------+------+------+---------+---------+

